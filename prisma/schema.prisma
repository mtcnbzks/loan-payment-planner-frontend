generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model installment {
  id                 BigInt   @id(map: "installment_pk") @default(autoincrement())
  loan_id            BigInt
  line_no            Int
  payment_date       DateTime @db.Timestamp(6)
  remaining_capital  Decimal  @db.Decimal(38, 2)
  capital_payment    Decimal  @db.Decimal(38, 2)
  interest_amount    Decimal  @db.Decimal(38, 2)
  kkdf_amount        Decimal  @db.Decimal(38, 2)
  bsmv_amount        Decimal  @db.Decimal(38, 2)
  installment_amount Decimal  @db.Decimal(38, 2)
  loan               loan     @relation(fields: [loan_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "installment_loan_id_fk")
}

model loan {
  id                     BigInt        @id @default(autoincrement())
  created_at             DateTime      @default(now()) @db.Timestamp(6)
  loan_group_id          Int
  type                   String        @db.VarChar
  installment_count      Int
  customer_type          String        @db.VarChar(255)
  currency_type          String        @db.VarChar(255)
  interest_rate          Decimal       @db.Decimal(38, 2)
  expense                Decimal       @db.Decimal(38, 2)
  kkdf_rate              Decimal       @db.Decimal(38, 2)
  bsmv_rate              Decimal       @db.Decimal(38, 2)
  amount                 Decimal       @db.Decimal(38, 2)
  first_installment_date DateTime      @db.Timestamp(6)
  period_frequency       Int           @db.SmallInt
  period_frequency_type  String        @db.VarChar(255)
  payment_type           String        @db.VarChar(255)
  search_name            String?       @unique(map: "loan_pk")
  installment            installment[]
  loan_group             loan_group    @relation(fields: [loan_group_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "loan_loan_group_id_fk")
}

model loan_group {
  id   Int    @id(map: "pk_loan_group")
  name String @unique(map: "uq_name_loan_group")
  loan loan[]
}

model loan_type {
  id                    Int    @id(map: "pk_loan_type")
  loan_group_id         Int
  name                  String @unique(map: "uq_name_loan_type")
  min_installment_count Float
  max_installment_count Float
  interest_rate         Float
  expense               Float? @default(0)
  kkdf_rate             Int?   @default(0)
  bsmv_rate             Float? @default(0)
}

enum currency_type {
  TL
}

enum customer_type {
  INDIVIDUAL
  CORPORATE
}

enum payment_type {
  REGULAR
}

enum period_frequency_type {
  MONTH
  YEAR
}
